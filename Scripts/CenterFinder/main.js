console.log("hi!");

var canvasDrawClass = require("./canvasDraw");
var canvasDraw = canvasDrawClass("contentCanvas");
canvasDraw.clear();


var polygonManager = require("./polygonManager");

// bezier facebook logo
var facebook = [];
polygonManager.addPointEntry(facebook, [0.666667, 0.234115], 4, 1, [0.666667, 0.234115], 0, [0.666667, 0.234115]);
polygonManager.addPointEntry(facebook, [0.825521, 0.166667], 4, 0, [0.825521, 0.166667], 1, [0.686458, 0.166667]);
polygonManager.addPointEntry(facebook, [1.000000, 0.166667], 1, 0, [1.000000, 0.166667], 0, [1.000000, 0.166667]);
polygonManager.addPointEntry(facebook, [1.000000, 0.000000], 1, 0, [1.000000, 0.000000], 0, [1.000000, 0.000000]);
polygonManager.addPointEntry(facebook, [0.708854, 0.000000], 4, 1, [0.352083, 0.000000], 0, [0.708854, 0.000000]);
polygonManager.addPointEntry(facebook, [0.234375, 0.222135], 4, 0, [0.234375, 0.081771], 1, [0.234375, 0.081771]);
polygonManager.addPointEntry(facebook, [0.234375, 0.333333], 1, 0, [0.234375, 0.333333], 0, [0.234375, 0.333333]);
polygonManager.addPointEntry(facebook, [0.000000, 0.333333], 1, 0, [0.000000, 0.333333], 0, [0.000000, 0.333333]);
polygonManager.addPointEntry(facebook, [0.000000, 0.500000], 1, 0, [0.000000, 0.500000], 0, [0.000000, 0.500000]);
polygonManager.addPointEntry(facebook, [0.234375, 0.500000], 1, 0, [0.234375, 0.500000], 0, [0.234375, 0.500000]);
polygonManager.addPointEntry(facebook, [0.234375, 1.000000], 1, 0, [0.234375, 1.000000], 0, [0.234375, 1.000000]);
polygonManager.addPointEntry(facebook, [0.666667, 1.000000], 1, 0, [0.666667, 1.000000], 0, [0.666667, 1.000000]);
polygonManager.addPointEntry(facebook, [0.666667, 0.500000], 1, 0, [0.666667, 0.500000], 0, [0.666667, 0.500000]);
polygonManager.addPointEntry(facebook, [0.960417, 0.500000], 1, 0, [0.960417, 0.500000], 0, [0.960417, 0.500000]);
polygonManager.addPointEntry(facebook, [1.000000, 0.333333], 1, 0, [1.000000, 0.333333], 0, [1.000000, 0.333333]);
polygonManager.addPointEntry(facebook, [0.666667, 0.333333], 1, 0, [0.666667, 0.333333], 0, [0.666667, 0.333333]);
canvasDraw.drawStrokedClosedPath(facebook, [300, 50, 192/2, 384/2]);


var extrudedFacebook = polygonManager.extrudeBezierPath(facebook);
var rect = [300, 50 + 250, 192/2, 384/2];
var centroid = polygonManager.findExtrudedPathCentroid(extrudedFacebook);
// canvasDraw.context.rotate(20*Math.PI/180);
var rect = [300, 50 + 250, 192/2, 384/2];
canvasDraw.context.fillStyle = 'grey';
canvasDraw.context.fillRect(rect[0], rect[1], rect[2], rect[3]);
var rotationDegrees = 20;
// rect = polygonManager.rotatedBoundingRect(rect, rotationDegrees);
var size = {width: rect[2], height: rect[3]};
// extrudedFacebook = polygonManager.rotatedExtrudedPath(extrudedFacebook, rotationDegrees, size, centroid);
console.log("rotated: ", extrudedFacebook);
// canvasDraw.drawStrokedClosedPath(extrudedFacebook, rect);

function drawRotatedPath(path, rect) {
  var centroid = polygonManager.findExtrudedPathCentroid(path);
  var size = {width: rect[2], height: rect[3]};
  for (var rotation = 0; rotation < 360; rotation += 90) {

    var rotated = polygonManager.rotatedExtrudedPath(path, rotation, size, centroid);
    canvasDraw.drawStrokedClosedPath(rotated, rect);
  }
}

drawRotatedPath(extrudedFacebook, rect);

// rotate left
var polygon = [];
polygonManager.addPointEntry(polygon, [0.905958565858884123934, 0.529375358212546776038], 4, 1, [0.903891072488077873537, 0.526654984560596228782], 0, [0.905958565858884123934, 0.529375358212546776038]);
polygonManager.addPointEntry(polygon, [0.901731690523013496019, 0.524388006517303995047], 4, 1, [0.900674971689045866796, 0.523330083430434189751], 1, [0.902880297951239141341, 0.525496306894024489687]);
polygonManager.addPointEntry(polygon, [0.898377756832594354108, 0.521466123705949580192], 4, 1, [0.897137260810110692688, 0.520609709778483753517], 1, [0.899618252855078237573, 0.522272160343564717522]);
polygonManager.addPointEntry(polygon, [0.894426547279497996534, 0.519451032111912125444], 2, 1, [0.893507661336917280437, 0.519048013793104723312], 1, [0.895804876193368682102, 0.520055559590123395175]);
polygonManager.addPointEntry(polygon, [0.891715833748885078336, 0.518090845285936962838], 2, 1, [0.889372674595304668621, 0.517939713416384228672], 1, [0.892726608285723810532, 0.518342731735191630804]);
polygonManager.addPointEntry(polygon, [0.888315955761337039398, 0.517536695097576715519], 4, 1, [0.884089080425466189439, 0.517939713416384228672], 1, [0.888913231624014477106, 0.517587072387427515885]);
polygonManager.addPointEntry(polygon, [0.88064325814078903143, 0.518644995474297321181], 4, 1, [0.877335268747498897568, 0.519954805010421572398], 1, [0.882389141431692225481, 0.518141222575787985249]);
polygonManager.addPointEntry(polygon, [0.874348889434112042096, 0.52116385996684411186], 4, 0, [0.874348889434112042096, 0.52116385996684411186], 1, [0.875727218347982838687, 0.520206691459676240363]);
polygonManager.addPointEntry(polygon, [0.729302743397767461175, 0.61884542498781103248], 4, 1, [0.718505833572445684609, 0.626150132016196847573], 0, [0.729302743397767461175, 0.61884542498781103248]);
polygonManager.addPointEntry(polygon, [0.721767878668606588377, 0.653505000405255609408], 2, 1, [0.728383857455186745078, 0.66534366352022578095], 1, [0.715105955584897423627, 0.641615960000434415456]);
polygonManager.addPointEntry(polygon, [0.753377555093378559192, 0.661766875940809295997], 4, 0, [0.753377555093378559192, 0.661766875940809295997], 1, [0.742580645268056893649, 0.669172337548896933868]);
polygonManager.addPointEntry(polygon, [0.856476557850919695269, 0.592397347816069008708], 4, 1, [0.838236671890695284048, 0.69113683592390551258], 0, [0.856476557850919695269, 0.592397347816069008708]);
polygonManager.addPointEntry(polygon, [0.719838218189187362128, 0.844938701838816030865], 3, 1, [0.636541207494257688104, 0.921612936991942022225], 1, [0.790959990144924351974, 0.779498602322448830293]);
polygonManager.addPointEntry(polygon, [0.42124623114762799192, 0.948061014163684157019], 2, 1, [0.312128525466184081338, 0.937884801613794616415], 1, [0.530272048234813664358, 0.958237226713573253534]);
polygonManager.addPointEntry(polygon, [0.142548124762938044352, 0.789876324031741905429], 2, 1, [0.0719317400756204761159, 0.698038524633483703496], 1, [0.213164509450255612588, 0.88171412342999999634]);
polygonManager.addPointEntry(polygon, [0.0474893740029770500266, 0.46192016710214217623], 2, 1, [0.0567701220230409156486, 0.342274103706166787919], 1, [0.0382086259829131982824, 0.581566230498117509029]);
polygonManager.addPointEntry(polygon, [0.191754466988128119409, 0.156331526866358372363], 2, 1, [0.275510920654348012704, 0.0789016323654682105726], 1, [0.10799801332190825387, 0.233711044077397567253]);
polygonManager.addPointEntry(polygon, [0.490851841298106883471, 0.052100914164769730752], 2, 1, [0.597856109311615480095, 0.062075617555255251101], 1, [0.381734135616663083912, 0.0418743243250295354985]);
polygonManager.addPointEntry(polygon, [0.765828459615345513711, 0.205449384471021956333], 3, 1, [0.774144377395699856415, 0.215927860760016826491], 1, [0.695533685007931112843, 0.1165838451739691084]);
polygonManager.addPointEntry(polygon, [0.798219189091310843409, 0.207968248963568802523], 2, 1, [0.807821547191277966604, 0.198849959500549205993], 1, [0.788754663882730966407, 0.217086538426588399053]);
polygonManager.addPointEntry(polygon, [0.800562348244891253124, 0.172401882328807265488], 3, 1, [0.722365154531283915063, 0.0735616396412688972051], 1, [0.8088323217281166988, 0.182930735907653102545]);
polygonManager.addPointEntry(polygon, [0.494757106554074232996, 0.0018747561833855677909], 2, 1, [0.37346416213343786028, -0.00956088861277715543197], 1, [0.613752836118259370579, 0.0129577599505916931516]);
polygonManager.addPointEntry(polygon, [0.162074451042775430354, 0.117742522840540625451], 2, 1, [0.0689913050593626980822, 0.203786933905941020084], 1, [0.255203541323317240064, 0.0315973571954383594673]);
polygonManager.addPointEntry(polygon, [0.00168290976533521014803, 0.457587720174961409825], 2, 1, [-0.00865455708869631787361, 0.590684519961137022293], 1, [0.0119744323222377158089, 0.324490920388786019402]);
polygonManager.addPointEntry(polygon, [0.107400737459230968818, 0.822268921405894359644], 2, 1, [0.185919541252741488124, 0.924333310643892680503], 1, [0.0288819336657203801222, 0.720154154878045016375]);
polygonManager.addPointEntry(polygon, [0.417340965891660531373, 0.998136040275515390441], 3, 1, [0.430664812059078971895, 0.999345095231937929903], 1, [0.295956132876766031536, 0.986851527348905466219]);
polygonManager.addPointEntry(polygon, [0.457128727205399709721, 1], 3, 1, [0.564316772407424394054, 1], 1, [0.443942713929368348857, 1]);
polygonManager.addPointEntry(polygon, [0.74933445694602418552, 0.883426951284931649688], 2, 1, [0.825831711665857448601, 0.813049877363172912581], 1, [0.666818499302288092423, 0.959345527090294081241]);
polygonManager.addPointEntry(polygon, [0.899112865586658593919, 0.613354300394058582491], 4, 0, [0.899112865586658593919, 0.613354300394058582491], 1, [0.877381213044627794595, 0.718743590762218720336]);
polygonManager.addPointEntry(polygon, [0.95750806723765458095, 0.717685667675349137085], 4, 1, [0.961826831167783335985, 0.725393393022542465332], 0, [0.95750806723765458095, 0.717685667675349137085]);
polygonManager.addPointEntry(polygon, [0.977080337814620780712, 0.729675462659872153814], 2, 1, [0.981215324556233392528, 0.729675462659872153814], 1, [0.969361695896944097761, 0.729675462659872153814]);
polygonManager.addPointEntry(polygon, [0.989117743662426440743, 0.725947543210902712651], 2, 1, [0.999868709190619431304, 0.718642836182516897559], 1, [0.985350311297846004344, 0.728516784993300636764]);
polygonManager.addPointEntry(polygon, [0.996606664094458305492, 0.691287967793458135723], 4, 0, [0.996606664094458305492, 0.691287967793458135723], 1, [1.00322264288103846219, 0.703126630908428307265]);
 
var rotateLeft = polygon;

console.log("rotate left");
rect = [500, 50, 350/2, 318/2];

// var extrudedRotateLeft = polygonManager.extrudeBezierPath(rotateLeft);
var calculatedRotateLeft = canvasDraw.drawStrokedClosedPath(rotateLeft, rect);

console.log("pre-calculated rotate left");
// rotate left, pre-calculted bezier
var polygon = [];
polygonManager.addBezierCurveEntry(polygon, [0.9059585658588841,0.5293753582125468]);
polygonManager.addBezierCurveEntry(polygon, [0.9017316905230135,0.5243880065173039], [0.9038910724880779,0.5266549845605962], [0.9028802979512391,0.5254963068940246]);
polygonManager.addBezierCurveEntry(polygon, [0.8983777568325944,0.5214661237059497], [0.9006749716890459,0.5233300834304342], [0.8996182528550782,0.5222721603435647]);
polygonManager.addBezierCurveEntry(polygon, [0.894426547279498,0.5194510321119122], [0.8971372608101107,0.5206097097784838], [0.8958048761933687,0.5200555595901234]);
polygonManager.addBezierCurveEntry(polygon, [0.8917158337488851,0.5180908452859371], [0.8935076613369173,0.5190480137931047], [0.8927266082857238,0.5183427317351916]);
polygonManager.addBezierCurveEntry(polygon, [0.888315955761337,0.5175366950975767], [0.8893726745953047,0.5179397134163842], [0.8889132316240145,0.5175870723874276]);
polygonManager.addBezierCurveEntry(polygon, [0.880643258140789,0.5186449954742972], [0.8840890804254662,0.5179397134163842], [0.8823891414316922,0.5181412225757881]);
polygonManager.addBezierCurveEntry(polygon, [0.874348889434112,0.5211638599668441], [0.8773352687474989,0.5199548050104217], [0.8757272183479828,0.5202066914596762]);
polygonManager.addBezierCurveEntry(polygon, [0.7293027433977674,0.6188454249878111], [0.874348889434112,0.5211638599668441], [0.7293027433977674,0.6188454249878111]);
polygonManager.addBezierCurveEntry(polygon, [0.7217678786686067,0.6535050004052556], [0.7185058335724457,0.6261501320161968], [0.7151059555848974,0.6416159600004345]);
polygonManager.addBezierCurveEntry(polygon, [0.7533775550933786,0.6617668759408092], [0.7283838574551867,0.6653436635202257], [0.7425806452680569,0.6691723375488969]);
polygonManager.addBezierCurveEntry(polygon, [0.8564765578509197,0.592397347816069], [0.7533775550933786,0.6617668759408092], [0.8564765578509197,0.592397347816069]);
polygonManager.addBezierCurveEntry(polygon, [0.7198382181891874,0.844938701838816], [0.8382366718906953,0.6911368359239054], [0.7909599901449244,0.7794986023224488]);
polygonManager.addBezierCurveEntry(polygon, [0.4212462311476279,0.9480610141636842], [0.6365412074942577,0.921612936991942], [0.5302720482348136,0.9582372267135733]);
polygonManager.addBezierCurveEntry(polygon, [0.14254812476293804,0.789876324031742], [0.3121285254661841,0.9378848016137946], [0.2131645094502556,0.88171412343]);
polygonManager.addBezierCurveEntry(polygon, [0.04748937400297709,0.4619201671021423], [0.07193174007562049,0.6980385246334838], [0.03820862598291317,0.5815662304981176]);
polygonManager.addBezierCurveEntry(polygon, [0.19175446698812815,0.1563315268663584], [0.056770122023040936,0.3422741037061668], [0.1079980133219083,0.23371104407739762]);
polygonManager.addBezierCurveEntry(polygon, [0.4908518412981069,0.0521009141647698], [0.275510920654348,0.07890163236546822], [0.3817341356166631,0.041874324325029535]);
polygonManager.addBezierCurveEntry(polygon, [0.7658284596153455,0.20544938447102198], [0.5978561093116156,0.062075617555255244], [0.695533685007931,0.11658384517396915]);
polygonManager.addBezierCurveEntry(polygon, [0.7982191890913108,0.20796824896356889], [0.7741443773956999,0.21592786076001688], [0.788754663882731,0.2170865384265884]);
polygonManager.addBezierCurveEntry(polygon, [0.8005623482448913,0.1724018823288073], [0.807821547191278,0.19884995950054923], [0.8088323217281167,0.18293073590765313]);
polygonManager.addBezierCurveEntry(polygon, [0.49475710655407423,0.0018747561833855702], [0.7223651545312839,0.07356163964126894], [0.6137528361182593,0.012957759950591747]);
polygonManager.addBezierCurveEntry(polygon, [0.16207445104277543,0.11774252284054067], [0.37346416213343786,-0.009560888612777168], [0.25520354132331724,0.03159735719543841]);
polygonManager.addBezierCurveEntry(polygon, [0.0016829097653352108,0.4575877201749614], [0.06899130505936267,0.20378693390594102], [0.011974432322237723,0.3244909203887861]);
polygonManager.addBezierCurveEntry(polygon, [0.10740073745923097,0.8222689214058944], [-0.008654557088696316,0.5906845199611369], [0.028881933665720356,0.7201541548780449]);
polygonManager.addBezierCurveEntry(polygon, [0.41734096589166053,0.9981360402755154], [0.1859195412527415,0.9243333106438927], [0.29595613287676603,0.9868515273489055]);
polygonManager.addBezierCurveEntry(polygon, [0.4571287272053997,1], [0.4306648120590791,0.9993450952319379], [0.44394271392936835,1]);
polygonManager.addBezierCurveEntry(polygon, [0.7493344569460242,0.8834269512849316], [0.5643167724074243,1], [0.6668184993022881,0.9593455270902941]);
polygonManager.addBezierCurveEntry(polygon, [0.8991128655866586,0.6133543003940586], [0.8258317116658574,0.8130498773631729], [0.8773812130446278,0.7187435907622187]);
polygonManager.addBezierCurveEntry(polygon, [0.9575080672376546,0.7176856676753491], [0.8991128655866586,0.6133543003940586], [0.9575080672376546,0.7176856676753491]);
polygonManager.addBezierCurveEntry(polygon, [0.9770803378146208,0.7296754626598722], [0.9618268311677833,0.7253933930225426], [0.9693616958969441,0.7296754626598722]);
polygonManager.addBezierCurveEntry(polygon, [0.9891177436624264,0.7259475432109027], [0.9812153245562334,0.7296754626598722], [0.985350311297846,0.7285167849933006]);
polygonManager.addBezierCurveEntry(polygon, [0.9966066640944583,0.6912879677934582], [0.9998687091906194,0.7186428361825169], [1.0032226428810385,0.7031266309084283]);
polygonManager.addBezierCurveEntry(polygon, [0.9059585658588841,0.5293753582125468], [0.9966066640944583,0.6912879677934582], [0.9059585658588841,0.5293753582125468]);
polygonManager.addBezierCurveEntry(polygon, [0.9059585658588841,0.5293753582125468], [0.9059585658588841,0.5293753582125468], [0.9059585658588841,0.5293753582125468]);
var rotateLeftPrecalculatedBezier = polygon;
rect = [550, 300, 350/2, 318/2];
canvasDraw.drawStrokedClosedPath(rotateLeftPrecalculatedBezier, rect);

function compareCalculatedBezierEntries(entries1, entries2) {
  var length = entries1.length;

  for (var index = 0; index < length; index +=1) {
    var entry1 = entries1[index];
    var entry2 = entries2[index];
    var xDiff = Math.abs(entry1.point.x - entry2.point.x)
    var yDiff = Math.abs(entry1.point.y - entry2.point.y)

    if (xDiff > 0.001) {
      console.log("#"+index+" difference x: ",xDiff, "entry 1: ", entry1.point.x);
    }

    if (yDiff > 0.001) {
      console.log("#"+index+" difference x: ",xDiff, "entry 1: ", entry1.point.x);
    }

    if (typeof entry1.controlPoint1 == 'undefined') {
      continue;
    }
    // console.log("entry 1: ", entry1);
    var controlPoint1XDiff = Math.abs(entry1.controlPoint1.x - entry2.controlPoint2.x);
    if (controlPoint1XDiff > 0.001) {
      console.log("#"+index+" difference cp1 x: ",controlPoint1XDiff, "entry 1: ", entry1.controlPoint1.x);
    }

  }


}

compareCalculatedBezierEntries(calculatedRotateLeft, rotateLeftPrecalculatedBezier);

// console.log("extruded: ", extrudedFacebook.length);
// check if HMR is enabled
if(module && module.hot) {
    // accept itself
    module.hot.accept();
    console.log("change accepted!");
}
